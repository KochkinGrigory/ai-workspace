# Визуальное оформление Excel таблиц

Это руководство описывает стандарты визуального оформления для Excel файлов.

## Общие таблицы (отчеты, дашборды, списки)

Для создания читаемых и профессионально выглядящих таблиц применяйте следующие принципы:

### Структура заголовков

- **Заголовки столбцов**: жирный текст, светлый нейтральный фон (например, светло-серый #D9E1F2 или #E7E6E6)
- **Итоговые/суммарные строки**: жирный текст, фон чуть темнее основных данных
- **Подзаголовки**: курсив или увеличенный отступ для визуальной иерархии

### Читаемость данных

- **Чередование строк (зебра)**: белый (#FFFFFF) и светло-серый (#F2F2F2) для длинных таблиц
- **Границы**: тонкие серые линии между ячейками, более жирные для разделения логических секций
- **Выравнивание**: текст влево, числа вправо, даты вправо или по центру
- **Отступы в ячейках**: добавлять padding для визуального "воздуха"

### Цветовое выделение по смыслу

Цвета используются для передачи смысла, а не функции:

- **Статусы**: зеленый = завершено/хорошо, желтый = в работе/внимание, красный = проблема/критично
- **Группировка данных**: светлые оттенки одного цвета для визуального объединения связанных строк/столбцов
- **Важные значения**: желтый или оранжевый фон для ячеек, требующих внимания
- **Примечания/комментарии**: светло-желтый (#FFF2CC) или светло-голубой (#D9EAD3) фон

### Условное форматирование

- **Градиенты**: от красного к зеленому для показателей производительности
- **Шкалы данных**: горизонтальные бары внутри ячеек для визуального сравнения значений
- **Наборы иконок**: галочки, крестики, стрелки для быстрой оценки статусов

### Структура листа

- **Замораживание областей**: закреплять заголовки строк/столбцов для навигации в больших таблицах
- **Ширина столбцов**: подбирать автоматически или устанавливать явно для оптимальной читаемости
- **Легенда**: размещать справа или снизу от таблицы, использовать меньший шрифт или курсив

### Примеры палитр по типу задачи

**Аналитические отчеты**: сдержанные серо-синие тона (#4472C4, #70AD47, #FFC000)

**Проектные дашборды**: яркие контрастные цвета для категорий

**Таблицы задач**: светофорная система (зеленый/желтый/красный)

**Расписания**: пастельные тона для мягкого восприятия

## Финансовые модели

Для финансовых моделей применяются строгие отраслевые стандарты цветового кодирования:

### Отраслевые стандартные цветовые соглашения

- **Синий текст (RGB: 0,0,255)**: Жестко закодированные входные данные и числа, которые пользователи будут изменять для сценариев
- **Черный текст (RGB: 0,0,0)**: ВСЕ формулы и вычисления
- **Зеленый текст (RGB: 0,128,0)**: Связи, извлекающие из других листов в той же книге
- **Красный текст (RGB: 255,0,0)**: Внешние ссылки на другие файлы
- **Желтый фон (RGB: 255,255,0)**: Ключевые предположения, требующие внимания, или ячейки, которые необходимо обновить

### Стандарты форматирования чисел

- **Годы**: Форматировать как текстовые строки (например, "2024" вместо "2,024")
- **Валюта**: Использовать формат $#,##0; ВСЕГДА указывать единицы в заголовках ("Revenue ($mm)")
- **Нули**: Использовать форматирование чисел, чтобы все нули стали "-", включая проценты (например, "$#,##0;($#,##0);-")
- **Проценты**: По умолчанию формат 0.0% (один знак после запятой)
- **Кратности**: Форматировать как 0.0x для мультипликаторов оценки (EV/EBITDA, P/E)
- **Отрицательные числа**: Использовать скобки (123) вместо минуса -123

### Правила построения формул

**Размещение предположений**:
- Размещать ВСЕ предположения (темпы роста, маржи, кратности и т.д.) в отдельных ячейках предположений
- Использовать ссылки на ячейки вместо жестко закодированных значений в формулах
- Пример: Использовать =B5*(1+$B$6) вместо =B5*1.05

**Предотвращение ошибок формул**:
- Проверить, что все ссылки на ячейки правильные
- Проверить ошибки смещения на единицу в диапазонах
- Обеспечить согласованность формул во всех периодах прогноза
- Тестировать с граничными случаями (нулевые значения, отрицательные числа)
- Проверить отсутствие непреднамеренных циклических ссылок

**Документация источников данных**:
- Комментировать или в ячейках рядом (если конец таблицы). Формат: "Source: [System/Document], [Date], [Specific Reference], [URL if applicable]"
- Примеры:
  - "Source: Company 10-K, FY2024, Page 45, Revenue Note, [SEC EDGAR URL]"
  - "Source: Company 10-Q, Q2 2025, Exhibit 99.1, [SEC EDGAR URL]"
  - "Source: Bloomberg Terminal, 8/15/2025, AAPL US Equity"
  - "Source: FactSet, 8/20/2025, Consensus Estimates Screen"

## Примеры применения в openpyxl

### Базовое оформление заголовков

```python
from openpyxl.styles import Font, PatternFill, Alignment

# Заголовок столбца
header_cell.font = Font(bold=True)
header_cell.fill = PatternFill('solid', start_color='D9E1F2')
header_cell.alignment = Alignment(horizontal='center')
```

### Зебра-эффект

```python
from openpyxl.styles import PatternFill

for row_idx, row in enumerate(sheet.iter_rows(min_row=2, max_row=sheet.max_row), start=2):
    if row_idx % 2 == 0:  # Четные строки
        fill = PatternFill('solid', start_color='F2F2F2')
        for cell in row:
            cell.fill = fill
```

### Цветовое кодирование для финансовых моделей

```python
from openpyxl.styles import Font

# Входные данные (синий)
input_cell.font = Font(color='0000FF')

# Формулы (черный) - по умолчанию
formula_cell.font = Font(color='000000')

# Внутренние ссылки (зеленый)
link_cell.font = Font(color='008000')

# Ключевые предположения (желтый фон)
assumption_cell.fill = PatternFill('solid', start_color='FFFF00')
```

## Поиск информации

Для быстрого поиска конкретной информации используй grep:

```bash
# Найти про цветовое кодирование для общих таблиц
grep -A 10 "Цветовое выделение" references/visual-styling.md

# Найти про финансовые модели
grep -A 20 "Финансовые модели" references/visual-styling.md

# Найти примеры кода openpyxl
grep -A 5 "openpyxl" references/visual-styling.md
```
